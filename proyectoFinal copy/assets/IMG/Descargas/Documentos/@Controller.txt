@Controller
public class HomeController {

    @Autowired
    private UsuarioDao udao;

    @Autowired
    private PerfilDao pdao;

    @Autowired
    private EventoDao edao;

    @Autowired
    private EventoDao erepo;

    @GetMapping({"/"})
    public String home() {
        return "home";
    }

    @GetMapping({"/login"})
    public String Login() {
        return "formLogin";
    }

    @PostMapping("/login")
    public String procLogin(@RequestParam("username") String username,
                            @RequestParam("password") String password,
                            HttpSession sesion, RedirectAttributes ratt) {
        System.out.println("Username: " + username);
        System.out.println("Password: " + password);

        Usuario usuario = udao.buscarPorUsernameYPassword(username, password);

        if (usuario != null) {
            usuario.setPassword(null);
            sesion.setAttribute("usuario", usuario);
            return "redirect:/home";
        }

        ratt.addFlashAttribute("mensaje", "Usuario o password incorrecto, int√©ntalo de nuevo");
        return "redirect:/login";
    }

    @GetMapping("/home")
    public String homeLoggedIn() {
        return "homeLoggedIn";  // Reemplaza "homeLoggedIn" con el nombre correcto de tu vista.
    }
}
